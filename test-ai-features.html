<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AI Features Test</title>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            margin: 20px;
            background: #f8f9fa;
        }
        .test-section {
            background: white;
            padding: 20px;
            margin: 20px 0;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        button {
            background: #0078d4;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 4px;
            cursor: pointer;
            margin: 5px;
        }
        button:hover {
            background: #106ebe;
        }
        .output {
            background: #f0f8ff;
            border: 1px solid #0078d4;
            padding: 15px;
            border-radius: 4px;
            margin-top: 10px;
            white-space: pre-wrap;
            font-family: 'Consolas', 'Monaco', monospace;
        }
        textarea {
            width: 100%;
            height: 100px;
            padding: 10px;
            border: 1px solid #ccc;
            border-radius: 4px;
            font-family: inherit;
            resize: vertical;
        }
    </style>
</head>
<body>
    <h1>🤖 AI Features Test Page</h1>
    
    <div class="test-section">
        <h2>Email Analysis Test</h2>
        <button onclick="testAnalyzeEmail()">📧 Test Email Analysis</button>
        <div id="analysisOutput" class="output" style="display: none;"></div>
    </div>
    
    <div class="test-section">
        <h2>Reply Generation Test</h2>
        <button onclick="testGenerateReply('professional')">🎯 Professional Reply</button>
        <button onclick="testGenerateReply('friendly')">😊 Friendly Reply</button>
        <button onclick="testGenerateReply('brief')">⚡ Brief Reply</button>
        <div id="replyOutput" class="output" style="display: none;"></div>
    </div>
    
    <div class="test-section">
        <h2>Custom Prompt Test</h2>
        <textarea id="testPrompt" placeholder="Enter test prompt (e.g., 'help', 'improve', 'professional')">help</textarea>
        <button onclick="testCustomPrompt()">🤖 Process Custom Prompt</button>
        <div id="customOutput" class="output" style="display: none;"></div>
    </div>
    
    <div class="test-section">
        <h2>Office.js Integration Test</h2>
        <button onclick="testOfficeJs()">🔧 Test Office.js Loading</button>
        <div id="officeOutput" class="output" style="display: none;"></div>
    </div>

    <script>
        // Test functions
        function testAnalyzeEmail() {
            console.log('Testing email analysis...');
            const testEmail = "Subject: Project Update\n\nHi team,\n\nI wanted to provide a quick update on the project status. We're making good progress and should be on track for the deadline. Please let me know if you have any questions.\n\nThanks,\nJohn";
            
            const analysis = generateEmailAnalysis(testEmail);
            showOutput('analysisOutput', 'Email Analysis Test Result', analysis);
        }
        
        function testGenerateReply(tone) {
            console.log('Testing reply generation for tone:', tone);
            const replies = {
                professional: 'Thank you for your email. I have reviewed your message and will provide a response shortly.\n\nI appreciate your patience and look forward to our continued correspondence.\n\nBest regards',
                friendly: 'Hi there!\n\nThanks for reaching out! I got your message and I will get back to you soon.\n\nHope you are having a great day!\n\nCheers',
                brief: 'Thanks for your email. Will respond shortly.\n\nBest'
            };
            
            showOutput('replyOutput', tone.charAt(0).toUpperCase() + tone.slice(1) + ' Reply', replies[tone]);
        }
        
        function testCustomPrompt() {
            const prompt = document.getElementById('testPrompt').value.trim();
            if (!prompt) {
                alert('Please enter a test prompt');
                return;
            }
            
            console.log('Testing custom prompt:', prompt);
            const response = generateCustomResponse(prompt);
            showOutput('customOutput', 'Custom AI Response', response);
        }
        
        function testOfficeJs() {
            console.log('Testing Office.js integration...');
            const output = document.getElementById('officeOutput');
            output.style.display = 'block';
            output.textContent = 'Loading Office.js...';
            
            // Try to load Office.js
            const script = document.createElement('script');
            script.src = 'https://appsforoffice.microsoft.com/lib/1/hosted/office.js';
            script.onload = function() {
                if (typeof Office !== 'undefined') {
                    output.textContent = '✅ Office.js loaded successfully!\n\nAvailable APIs:\n' + 
                                        '- Office.context: ' + (typeof Office.context !== 'undefined') + '\n' +
                                        '- Office.onReady: ' + (typeof Office.onReady !== 'undefined') + '\n' +
                                        '- Current environment: ' + (typeof Office.context !== 'undefined' && Office.context.host ? 'Office Application' : 'Browser/Standalone');
                } else {
                    output.textContent = '❌ Office.js loaded but Office object not available';
                }
            };
            script.onerror = function() {
                output.textContent = '❌ Office.js failed to load\n\nThis is normal when testing outside of Office applications.';
            };
            document.head.appendChild(script);
        }
        
        function showOutput(elementId, title, content) {
            const output = document.getElementById(elementId);
            output.style.display = 'block';
            output.textContent = `=== ${title} ===\n\n${content}`;
        }
        
        // AI Logic functions (copied from main app)
        function generateEmailAnalysis(content) {
            const wordCount = content.split(/\s+/).length;
            const hasSubject = content.includes('Subject:') || content.length > 0;
            const tone = content.toLowerCase().includes('please') || content.toLowerCase().includes('thank') ? 'polite' : 'neutral';
            
            return 'Email Analysis Results:\n\n' +
                   '📊 Structure:\n' +
                   '• Word count: ' + wordCount + ' words\n' +
                   '• Length: ' + (wordCount < 50 ? 'Concise' : wordCount < 150 ? 'Appropriate' : 'Lengthy') + '\n' +
                   '• Tone: ' + tone.charAt(0).toUpperCase() + tone.slice(1) + '\n\n' +
                   '✅ Strengths:\n' +
                   '• Clear communication intent\n' +
                   '• Appropriate for email format\n' +
                   (content.includes('?') ? '• Contains questions for engagement\n' : '') + '\n' +
                   '💡 Suggestions:\n' +
                   (wordCount > 200 ? '• Consider shortening for better readability\n' : '') +
                   '• Ensure clear subject line\n' +
                   '• Include specific call-to-action if needed\n' +
                   '• Review for typos before sending\n\n' +
                   '📈 Overall Score: ' + (Math.floor(Math.random() * 20) + 80) + '/100';
        }
        
        function generateCustomResponse(prompt) {
            const responses = {
                'help': 'I am here to help! Here are some ways I can assist with your emails:\n\n• Analyze email content and tone\n• Generate professional replies\n• Suggest improvements\n• Create custom responses\n\nWhat would you like me to help you with?',
                'improve': 'Here are some suggestions to improve your email:\n\n• Use clear, concise language\n• Structure with bullet points or paragraphs\n• Include a clear subject line\n• End with specific next steps\n• Proofread for clarity and tone',
                'professional': 'Here is a professional email template:\n\nSubject: [Clear, specific subject]\n\nDear [Name],\n\nI hope this email finds you well. I am writing to [purpose].\n\n[Main content with clear points]\n\nI would appreciate [specific request/next steps].\n\nThank you for your time and consideration.\n\nBest regards,\n[Your name]'
            };
            
            // Simple keyword matching
            const lowerPrompt = prompt.toLowerCase();
            for (const keyword in responses) {
                if (lowerPrompt.includes(keyword)) {
                    return responses[keyword];
                }
            }
            
            // Generic response
            return 'Based on your prompt: "' + prompt + '"\n\nHere are some suggestions:\n\n• Be specific about your goals\n• Consider your audience\n• Use clear, actionable language\n• Maintain appropriate tone\n• Include relevant details\n\nWould you like me to help with a more specific aspect of your email?';
        }
        
        console.log('AI Features Test Page loaded successfully!');
        console.log('Available tests:');
        console.log('- Email Analysis');
        console.log('- Reply Generation (Professional, Friendly, Brief)');
        console.log('- Custom Prompt Processing');
        console.log('- Office.js Integration');
    </script>
</body>
</html>
