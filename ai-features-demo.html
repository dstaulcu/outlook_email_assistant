<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PromptReply AI Features Demo</title>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            margin: 0;
            padding: 20px;
            background: #f8f9fa;
            color: #323130;
        }
        .container {
            max-width: 800px;
            margin: 0 auto;
            background: white;
            padding: 30px;
            border-radius: 8px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }
        h1 {
            color: #0078d4;
            text-align: center;
            margin-bottom: 30px;
        }
        .demo-section {
            background: #f8f9fa;
            padding: 20px;
            margin: 20px 0;
            border-radius: 8px;
            border-left: 4px solid #0078d4;
        }
        button {
            background: #0078d4;
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 4px;
            cursor: pointer;
            margin: 8px 8px 8px 0;
            font-size: 14px;
            transition: all 0.2s;
        }
        button:hover {
            background: #106ebe;
            transform: translateY(-1px);
        }
        button:disabled {
            background: #ccc;
            cursor: not-allowed;
            transform: none;
        }
        .output {
            background: white;
            border: 1px solid #e1dfdd;
            padding: 15px;
            border-radius: 4px;
            margin-top: 15px;
            white-space: pre-wrap;
            font-family: 'Consolas', 'Monaco', monospace;
            font-size: 13px;
            line-height: 1.5;
            min-height: 40px;
        }
        .output.loading {
            background: #f0f8ff;
            border-color: #0078d4;
            color: #0078d4;
        }
        textarea {
            width: 100%;
            height: 100px;
            padding: 12px;
            border: 1px solid #e1dfdd;
            border-radius: 4px;
            font-family: inherit;
            font-size: 14px;
            resize: vertical;
            margin-top: 8px;
        }
        .status {
            background: #e8f4f8;
            border: 1px solid #0078d4;
            padding: 10px;
            border-radius: 4px;
            margin-bottom: 20px;
            text-align: center;
            font-weight: 500;
        }
        .feature-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 10px;
            margin-top: 10px;
        }
        .success {
            background: #d4edda;
            border-color: #c3e6cb;
            color: #155724;
        }
        .error {
            background: #f8d7da;
            border-color: #f5c6cb;
            color: #721c24;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>ü§ñ PromptReply AI Features Demo</h1>
        
        <div class="status" id="mainStatus">
            Ready to test AI features - No Office.js required for this demo
        </div>

        <div class="demo-section">
            <h2>üìß Email Analysis</h2>
            <p>Test the AI's ability to analyze email content and provide insights:</p>
            
            <textarea id="emailContent" placeholder="Enter email content to analyze...">Subject: Project Update Meeting

Hi team,

I wanted to schedule a meeting to discuss the project status. We need to review the deliverables and make sure we're on track for the deadline. 

Please let me know your availability for next week.

Thanks,
John</textarea>
            
            <br>
            <button onclick="demoAnalyzeEmail()">üìä Analyze Email</button>
            <button onclick="clearOutput('emailOutput')">üóëÔ∏è Clear</button>
            
            <div id="emailOutput" class="output"></div>
        </div>

        <div class="demo-section">
            <h2>üí¨ Reply Generation</h2>
            <p>Generate different types of replies automatically:</p>
            
            <div class="feature-grid">
                <button onclick="demoGenerateReply('professional')">üéØ Professional</button>
                <button onclick="demoGenerateReply('friendly')">üòä Friendly</button>
                <button onclick="demoGenerateReply('brief')">‚ö° Brief</button>
            </div>
            
            <div id="replyOutput" class="output"></div>
        </div>

        <div class="demo-section">
            <h2>ü§ñ Custom AI Prompts</h2>
            <p>Test custom prompts and AI responses:</p>
            
            <textarea id="customPrompt" placeholder="Enter your custom prompt...">help</textarea>
            
            <br>
            <button onclick="demoCustomPrompt()">üöÄ Process Prompt</button>
            <button onclick="setPrompt('help')">üí° Help</button>
            <button onclick="setPrompt('improve')">üìà Improve</button>
            <button onclick="setPrompt('professional')">üìù Professional</button>
            <button onclick="clearOutput('customOutput')">üóëÔ∏è Clear</button>
            
            <div id="customOutput" class="output"></div>
        </div>

        <div class="demo-section">
            <h2>üîß Integration Test</h2>
            <p>Test clipboard and Office.js integration:</p>
            
            <button onclick="testClipboard()">üìã Test Clipboard</button>
            <button onclick="testOfficeJs()">üè¢ Test Office.js</button>
            
            <div id="integrationOutput" class="output"></div>
        </div>
    </div>

    <script>
        // Demo functions
        function demoAnalyzeEmail() {
            const content = document.getElementById('emailContent').value.trim();
            if (!content) {
                showOutput('emailOutput', 'Please enter email content to analyze.', 'error');
                return;
            }
            
            showOutput('emailOutput', 'Analyzing email...', 'loading');
            
            setTimeout(() => {
                const analysis = generateEmailAnalysis(content);
                showOutput('emailOutput', analysis, 'success');
            }, 1000);
        }
        
        function demoGenerateReply(tone) {
            showOutput('replyOutput', 'Generating ' + tone + ' reply...', 'loading');
            
            setTimeout(() => {
                const replies = {
                    professional: 'Thank you for your email. I have reviewed your message and will provide a response shortly.\n\nI appreciate your patience and look forward to our continued correspondence.\n\nBest regards',
                    friendly: 'Hi there!\n\nThanks for reaching out! I got your message and I will get back to you soon.\n\nHope you are having a great day!\n\nCheers',
                    brief: 'Thanks for your email. Will respond shortly.\n\nBest'
                };
                
                const reply = replies[tone] || replies.professional;
                showOutput('replyOutput', reply, 'success');
            }, 1500);
        }
        
        function demoCustomPrompt() {
            const prompt = document.getElementById('customPrompt').value.trim();
            if (!prompt) {
                showOutput('customOutput', 'Please enter a prompt first.', 'error');
                return;
            }
            
            showOutput('customOutput', 'Processing prompt...', 'loading');
            
            setTimeout(() => {
                const response = generateCustomResponse(prompt);
                showOutput('customOutput', response, 'success');
            }, 2000);
        }
        
        function setPrompt(text) {
            document.getElementById('customPrompt').value = text;
        }
        
        function testClipboard() {
            const testText = 'This is a test clipboard content from PromptReply AI Assistant.';
            
            if (navigator.clipboard && navigator.clipboard.writeText) {
                navigator.clipboard.writeText(testText).then(() => {
                    showOutput('integrationOutput', '‚úÖ Clipboard test successful!\n\nTest text copied to clipboard:\n"' + testText + '"', 'success');
                }).catch(err => {
                    showOutput('integrationOutput', '‚ùå Clipboard test failed:\n' + err.message, 'error');
                });
            } else {
                showOutput('integrationOutput', '‚ùå Clipboard API not available in this browser/environment', 'error');
            }
        }
        
        function testOfficeJs() {
            showOutput('integrationOutput', 'Testing Office.js integration...', 'loading');
            
            // Check if Office.js is already loaded
            if (typeof Office !== 'undefined') {
                showOutput('integrationOutput', '‚úÖ Office.js already loaded!\n\nEnvironment: ' + (Office.context ? 'Office Application' : 'Standalone'), 'success');
                return;
            }
            
            // Try to load Office.js
            const script = document.createElement('script');
            script.src = 'https://appsforoffice.microsoft.com/lib/1/hosted/office.js';
            script.onload = function() {
                if (typeof Office !== 'undefined') {
                    const context = Office.context ? 'Office Application' : 'Standalone';
                    showOutput('integrationOutput', '‚úÖ Office.js loaded successfully!\n\nEnvironment: ' + context + '\nHost: ' + (Office.context?.host || 'Unknown'), 'success');
                } else {
                    showOutput('integrationOutput', '‚ùå Office.js loaded but Office object not available', 'error');
                }
            };
            script.onerror = function() {
                showOutput('integrationOutput', '‚ùå Office.js failed to load\n\nThis is normal when testing outside of Office applications.', 'error');
            };
            document.head.appendChild(script);
        }
        
        function showOutput(elementId, content, type = 'default') {
            const output = document.getElementById(elementId);
            output.textContent = content;
            output.className = 'output';
            
            if (type === 'loading') {
                output.className += ' loading';
            } else if (type === 'success') {
                output.className += ' success';
            } else if (type === 'error') {
                output.className += ' error';
            }
        }
        
        function clearOutput(elementId) {
            const output = document.getElementById(elementId);
            output.textContent = '';
            output.className = 'output';
        }
        
        // AI Logic functions
        function generateEmailAnalysis(content) {
            const wordCount = content.split(/\s+/).length;
            const hasSubject = content.includes('Subject:');
            const hasQuestions = content.includes('?');
            const hasGreeting = /\b(hi|hello|dear|hey)\b/i.test(content);
            const hasClosing = /\b(thanks|regards|best|sincerely)\b/i.test(content);
            const tone = content.toLowerCase().includes('please') || content.toLowerCase().includes('thank') ? 'polite' : 'neutral';
            
            let score = 70;
            if (hasSubject) score += 10;
            if (hasGreeting) score += 5;
            if (hasClosing) score += 5;
            if (wordCount > 20 && wordCount < 200) score += 10;
            
            return 'üìä EMAIL ANALYSIS RESULTS\n\n' +
                   'üìà Structure Analysis:\n' +
                   '‚Ä¢ Word count: ' + wordCount + ' words\n' +
                   '‚Ä¢ Length: ' + (wordCount < 50 ? 'Concise' : wordCount < 150 ? 'Appropriate' : 'Lengthy') + '\n' +
                   '‚Ä¢ Has subject line: ' + (hasSubject ? 'Yes ‚úÖ' : 'No ‚ùå') + '\n' +
                   '‚Ä¢ Has greeting: ' + (hasGreeting ? 'Yes ‚úÖ' : 'No ‚ùå') + '\n' +
                   '‚Ä¢ Has closing: ' + (hasClosing ? 'Yes ‚úÖ' : 'No ‚ùå') + '\n' +
                   '‚Ä¢ Tone: ' + tone.charAt(0).toUpperCase() + tone.slice(1) + '\n\n' +
                   '‚úÖ Strengths:\n' +
                   '‚Ä¢ Clear communication intent\n' +
                   '‚Ä¢ Appropriate for email format\n' +
                   (hasQuestions ? '‚Ä¢ Contains questions for engagement\n' : '') +
                   (hasGreeting ? '‚Ä¢ Professional greeting included\n' : '') +
                   (hasClosing ? '‚Ä¢ Proper closing statement\n' : '') + '\n' +
                   'üí° Suggestions:\n' +
                   (!hasSubject ? '‚Ä¢ Add clear subject line\n' : '') +
                   (!hasGreeting ? '‚Ä¢ Consider adding greeting\n' : '') +
                   (!hasClosing ? '‚Ä¢ Add professional closing\n' : '') +
                   (wordCount > 200 ? '‚Ä¢ Consider shortening for better readability\n' : '') +
                   '‚Ä¢ Review for typos before sending\n' +
                   '‚Ä¢ Include clear call-to-action if needed\n\n' +
                   'üìà Overall Score: ' + Math.min(score, 100) + '/100';
        }
        
        function generateCustomResponse(prompt) {
            const responses = {
                'help': 'I am here to help! Here are some ways I can assist with your emails:\n\n‚Ä¢ üìß Analyze email content and tone\n‚Ä¢ üí¨ Generate professional replies\n‚Ä¢ üìù Suggest improvements\n‚Ä¢ ü§ñ Create custom responses\n‚Ä¢ üìä Provide writing insights\n\nWhat would you like me to help you with?',
                'improve': 'Here are some suggestions to improve your email:\n\n‚úÖ Structure:\n‚Ä¢ Use clear, concise language\n‚Ä¢ Structure with bullet points or paragraphs\n‚Ä¢ Include a clear subject line\n‚Ä¢ Start with appropriate greeting\n‚Ä¢ End with specific next steps\n\n‚úÖ Tone:\n‚Ä¢ Match tone to audience\n‚Ä¢ Be professional but not overly formal\n‚Ä¢ Use active voice when possible\n‚Ä¢ Proofread for clarity and errors\n\n‚úÖ Content:\n‚Ä¢ Be specific about requests\n‚Ä¢ Include relevant context\n‚Ä¢ Provide clear deadlines\n‚Ä¢ Make action items obvious',
                'professional': 'Here is a professional email template:\n\nüìß PROFESSIONAL EMAIL TEMPLATE\n\nSubject: [Clear, specific subject]\n\nDear [Name],\n\nI hope this email finds you well. I am writing to [purpose].\n\n[Main content with clear points]\n\nSpecifically, I would like to:\n‚Ä¢ [Action item 1]\n‚Ä¢ [Action item 2]\n‚Ä¢ [Action item 3]\n\nI would appreciate [specific request/next steps] by [date].\n\nThank you for your time and consideration.\n\nBest regards,\n[Your name]\n[Your title]\n[Contact information]'
            };
            
            // Simple keyword matching
            const lowerPrompt = prompt.toLowerCase();
            for (const keyword in responses) {
                if (lowerPrompt.includes(keyword)) {
                    return responses[keyword];
                }
            }
            
            // Generic response based on prompt analysis
            let response = 'Based on your prompt: "' + prompt + '"\n\n';
            
            if (lowerPrompt.includes('write') || lowerPrompt.includes('compose')) {
                response += 'üìù Writing Assistance:\n‚Ä¢ Be clear about your purpose\n‚Ä¢ Use appropriate tone for audience\n‚Ä¢ Include specific details\n‚Ä¢ Structure with clear sections\n‚Ä¢ End with clear next steps';
            } else if (lowerPrompt.includes('reply') || lowerPrompt.includes('respond')) {
                response += 'üí¨ Reply Guidance:\n‚Ä¢ Acknowledge their message\n‚Ä¢ Address all their points\n‚Ä¢ Be timely with response\n‚Ä¢ Match their tone appropriately\n‚Ä¢ Include clear next actions';
            } else if (lowerPrompt.includes('format') || lowerPrompt.includes('structure')) {
                response += 'üìä Format Suggestions:\n‚Ä¢ Use clear subject line\n‚Ä¢ Start with greeting\n‚Ä¢ Organize with bullet points\n‚Ä¢ End with professional closing\n‚Ä¢ Include signature block';
            } else {
                response += 'ü§ñ General Suggestions:\n‚Ä¢ Be specific about your goals\n‚Ä¢ Consider your audience\n‚Ä¢ Use clear, actionable language\n‚Ä¢ Maintain appropriate tone\n‚Ä¢ Include relevant details\n\nWould you like me to help with a more specific aspect of your email?';
            }
            
            return response;
        }
        
        console.log('PromptReply AI Features Demo loaded successfully!');
    </script>
</body>
</html>
