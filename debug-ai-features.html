<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AI Features Debug Test</title>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            margin: 20px;
            background: #f8f9fa;
        }
        .test-container {
            background: white;
            padding: 20px;
            border-radius: 8px;
            margin-bottom: 20px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        button {
            background: #0078d4;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 4px;
            cursor: pointer;
            margin: 5px;
        }
        button:hover {
            background: #106ebe;
        }
        .console-output {
            background: #000;
            color: #0f0;
            padding: 15px;
            border-radius: 4px;
            font-family: 'Consolas', monospace;
            font-size: 12px;
            height: 300px;
            overflow-y: auto;
            white-space: pre-wrap;
        }
        textarea {
            width: 100%;
            height: 80px;
            padding: 10px;
            border: 1px solid #ccc;
            border-radius: 4px;
            font-family: inherit;
            resize: vertical;
        }
        .output-box {
            background: #f0f8ff;
            border: 1px solid #0078d4;
            padding: 15px;
            border-radius: 4px;
            margin-top: 10px;
            white-space: pre-wrap;
            font-family: 'Consolas', monospace;
            font-size: 13px;
            min-height: 50px;
        }
    </style>
</head>
<body>
    <h1>ğŸ”§ AI Features Debug Test</h1>
    
    <div class="test-container">
        <h2>Function Tests</h2>
        <button onclick="testAnalyzeEmail()">ğŸ“§ Test Email Analysis</button>
        <button onclick="testGenerateReply()">ğŸ’¬ Test Reply Generation</button>
        <button onclick="testCustomPrompt()">ğŸ¤– Test Custom Prompt</button>
        <button onclick="testClipboard()">ğŸ“‹ Test Clipboard</button>
        <button onclick="clearConsole()">ğŸ—‘ï¸ Clear Console</button>
    </div>
    
    <div class="test-container">
        <h2>Custom Prompt Test</h2>
        <textarea id="debugPrompt" placeholder="Enter test prompt">help</textarea>
        <button onclick="testCustomPromptWithInput()">ğŸš€ Test Custom Prompt</button>
        <div id="promptOutput" class="output-box"></div>
    </div>
    
    <div class="test-container">
        <h2>Console Output</h2>
        <div id="consoleOutput" class="console-output"></div>
    </div>

    <script>
        // Console logging
        function log(message, type = 'info') {
            const timestamp = new Date().toLocaleTimeString();
            const consoleOutput = document.getElementById('consoleOutput');
            const logEntry = `[${timestamp}] ${type.toUpperCase()}: ${message}\n`;
            consoleOutput.textContent += logEntry;
            consoleOutput.scrollTop = consoleOutput.scrollHeight;
            
            // Also log to browser console
            console.log(logEntry);
        }
        
        function clearConsole() {
            document.getElementById('consoleOutput').textContent = '';
        }
        
        // Test functions
        function testAnalyzeEmail() {
            log('Testing analyzeEmail function...');
            try {
                const testEmail = "Subject: Test Email\n\nHello team,\n\nThis is a test email to check the analysis functionality. Please review and let me know if you have any questions.\n\nThanks,\nTest User";
                const result = generateEmailAnalysis(testEmail);
                log('Email analysis successful', 'success');
                log('Analysis result: ' + result.substring(0, 100) + '...');
            } catch (error) {
                log('Email analysis failed: ' + error.message, 'error');
            }
        }
        
        function testGenerateReply() {
            log('Testing generateReply function...');
            try {
                const replies = {
                    professional: 'Thank you for your email. I have reviewed your message and will provide a response shortly.\n\nI appreciate your patience and look forward to our continued correspondence.\n\nBest regards',
                    friendly: 'Hi there!\n\nThanks for reaching out! I got your message and I will get back to you soon.\n\nHope you are having a great day!\n\nCheers',
                    brief: 'Thanks for your email. Will respond shortly.\n\nBest'
                };
                
                const reply = replies['professional'];
                log('Reply generation successful', 'success');
                log('Reply: ' + reply);
            } catch (error) {
                log('Reply generation failed: ' + error.message, 'error');
            }
        }
        
        function testCustomPrompt() {
            log('Testing processCustomPrompt function...');
            try {
                const testPrompt = 'help';
                const result = generateCustomResponse(testPrompt);
                log('Custom prompt processing successful', 'success');
                log('Response: ' + result.substring(0, 100) + '...');
            } catch (error) {
                log('Custom prompt processing failed: ' + error.message, 'error');
            }
        }
        
        function testCustomPromptWithInput() {
            const prompt = document.getElementById('debugPrompt').value.trim();
            const outputDiv = document.getElementById('promptOutput');
            
            if (!prompt) {
                outputDiv.textContent = 'Please enter a prompt to test.';
                return;
            }
            
            log('Testing custom prompt with input: ' + prompt);
            outputDiv.textContent = 'Processing...';
            
            try {
                const result = generateCustomResponse(prompt);
                outputDiv.textContent = result;
                log('Custom prompt with input successful', 'success');
            } catch (error) {
                outputDiv.textContent = 'Error: ' + error.message;
                log('Custom prompt with input failed: ' + error.message, 'error');
            }
        }
        
        function testClipboard() {
            log('Testing clipboard functionality...');
            const testText = 'This is a test clipboard content.';
            
            if (navigator.clipboard && navigator.clipboard.writeText) {
                navigator.clipboard.writeText(testText).then(() => {
                    log('Clipboard test successful', 'success');
                }).catch(err => {
                    log('Clipboard test failed: ' + err.message, 'error');
                });
            } else {
                log('Clipboard API not available', 'warning');
            }
        }
        
        // AI Logic functions (same as in main app)
        function generateEmailAnalysis(content) {
            const wordCount = content.split(/\s+/).length;
            const hasSubject = content.includes('Subject:');
            const hasQuestions = content.includes('?');
            const hasGreeting = /\b(hi|hello|dear|hey)\b/i.test(content);
            const hasClosing = /\b(thanks|regards|best|sincerely)\b/i.test(content);
            const tone = content.toLowerCase().includes('please') || content.toLowerCase().includes('thank') ? 'polite' : 'neutral';
            
            return 'Email Analysis Results:\n\n' +
                   'ğŸ“Š Structure:\n' +
                   'â€¢ Word count: ' + wordCount + ' words\n' +
                   'â€¢ Length: ' + (wordCount < 50 ? 'Concise' : wordCount < 150 ? 'Appropriate' : 'Lengthy') + '\n' +
                   'â€¢ Has subject: ' + (hasSubject ? 'Yes' : 'No') + '\n' +
                   'â€¢ Has greeting: ' + (hasGreeting ? 'Yes' : 'No') + '\n' +
                   'â€¢ Has closing: ' + (hasClosing ? 'Yes' : 'No') + '\n' +
                   'â€¢ Tone: ' + tone.charAt(0).toUpperCase() + tone.slice(1) + '\n\n' +
                   'âœ… Strengths:\n' +
                   'â€¢ Clear communication intent\n' +
                   'â€¢ Appropriate for email format\n' +
                   (hasQuestions ? 'â€¢ Contains questions for engagement\n' : '') + '\n' +
                   'ğŸ’¡ Suggestions:\n' +
                   (wordCount > 200 ? 'â€¢ Consider shortening for better readability\n' : '') +
                   'â€¢ Ensure clear subject line\n' +
                   'â€¢ Include specific call-to-action if needed\n' +
                   'â€¢ Review for typos before sending\n\n' +
                   'ğŸ“ˆ Overall Score: ' + (Math.floor(Math.random() * 20) + 80) + '/100';
        }
        
        function generateCustomResponse(prompt) {
            const responses = {
                'help': 'I am here to help! Here are some ways I can assist with your emails:\n\nâ€¢ Analyze email content and tone\nâ€¢ Generate professional replies\nâ€¢ Suggest improvements\nâ€¢ Create custom responses\n\nWhat would you like me to help you with?',
                'improve': 'Here are some suggestions to improve your email:\n\nâ€¢ Use clear, concise language\nâ€¢ Structure with bullet points or paragraphs\nâ€¢ Include a clear subject line\nâ€¢ End with specific next steps\nâ€¢ Proofread for clarity and tone',
                'professional': 'Here is a professional email template:\n\nSubject: [Clear, specific subject]\n\nDear [Name],\n\nI hope this email finds you well. I am writing to [purpose].\n\n[Main content with clear points]\n\nI would appreciate [specific request/next steps].\n\nThank you for your time and consideration.\n\nBest regards,\n[Your name]'
            };
            
            // Simple keyword matching
            const lowerPrompt = prompt.toLowerCase();
            for (const keyword in responses) {
                if (lowerPrompt.includes(keyword)) {
                    return responses[keyword];
                }
            }
            
            // Generic response
            return 'Based on your prompt: "' + prompt + '"\n\nHere are some suggestions:\n\nâ€¢ Be specific about your goals\nâ€¢ Consider your audience\nâ€¢ Use clear, actionable language\nâ€¢ Maintain appropriate tone\nâ€¢ Include relevant details\n\nWould you like me to help with a more specific aspect of your email?';
        }
        
        // Initialize
        document.addEventListener('DOMContentLoaded', function() {
            log('AI Features Debug Test loaded successfully');
            log('Testing core functions...');
            
            // Test all functions on load
            setTimeout(() => {
                testAnalyzeEmail();
                testGenerateReply();
                testCustomPrompt();
                testClipboard();
            }, 100);
        });
    </script>
</body>
</html>
